### 绪论

1. 现代操作系统的两个最基本的特征是并发和共享（还有虚拟和异步）

2. 操作系统的五大功能是：处理器管理、存储器管理、文件管理（信息管理）、设备管理和提供用户接口

3. 从系统观点看，操作系统是计算机系统中的一个系统软件，它管理和控制计算机系统中的资源；从用户观点看，操作系统是用户与计算机之间的接口；从软件观点看，操作系统是程序和数据结构的集合。

4. 允许多个用户以交互方法使用计算机的操作系统称为分时操作系统；允许多个用户将多个作业交给计算机集中处理的操作系统称为批处理操作系统；能及时处理过程、控制数据并做出相应操作的计算机系统称为实时操作系统。

   - 单用户单任务操作系统：MS-DOS

   - 单用户多任务操作系统：windows

   - 多用户多任务操作系统：Linux（UNIX）

5. 批处理操作系统主要缺点是缺少交互性。虽然批处理操作系统提高了计算机系统的工作效率，但用户不能直接干预作业的执行。

6. 实时操作系统应具有两个基本的特征：及时性和高可靠性，即实时操作系统必须在规定的时间内处理完来自外部的事件并且保证系统的安全性和稳定性，因此实时操作系统常用在订票系统、银行系统等对反馈时间及可靠性要求高的地方。
   - 分时操作系统：满足用户对人——机交互的需求，引入了时间片的概念，系统规定每个作业每次只能运行一个时间片（例如30ms），然后就暂停该作业的运行，并立即调度下一个作业运行。如果在不长的时间内能使所有的作业都执行一个时间片的时间，便可以使每个用户都能及时地与自己的作业进行交互，从而可使用户的请求得到及时响应。

7. 操作系统中采用多道程序设计技术后，提高了CPU和外部设备（外设）的利用率，多道运行的特征之一是宏观上并行，其含义是同时间入系统的几道程序都处于运行状态，即它们先后开始了各自的运行，但均未运行完毕。
   - 并行和并发：并行性是指两个或多个事件在同一时刻发生。而并发性是指两个或多个事件在同一时间间隔内发生。

8. 多道程序设计技术是指将一个以上的作业放入主存，并且使之同时处于运行状态。这些作业共享处理器和外设等资源。

9. 操作系统程序的运行状态成为内核态（或管态），用户程序的运行状态称为用户态（或目态），用户态切换到内核态的唯一方法——中断。

10. 通常异常会引起终端，而中断未必是由异常引起的。

11. 系统中与资源有关的操作，都必须通过系统调用向操作系统提出请求，由操作系统代为完成。
    - 系统调用（Application Programming Interface, API）：进程控制、文件系统控制、系统控制、内存管理、网络管理、socket控制、用户管理以及进程间通信。



### 进程管理

1. 进程是一个程序对某个数据集的一次运行活动。进程是动态的概念，而程序是静态的概念。
   - 进程的组织形式：链接方式、索引方式
2. 进程的基本特征是：动态性、并发性、独立性、异步性和结构特征。

   - 动态性：进程是程序的一次执行过程，是动态地产生、变化和消亡的

   - 并发性：内存中有多个进程实体，各进程可并发执行

   - 独立性：进程是系统进行资源分配、调度的基本单位（引入线程后，进程是资源分配的基本单位，线程是调度的基本单位）

   - 异步性：各进程按各自独立的、不可预知的速度向前推进，可能导致运行结果的不确定性

   - 结构性：每个进程都会配置一个PCB。结构上看，进程由程序段、数据段、PCB组成。
3. 程序段和数据段称为进程的实体，用PCB描述实体的存在和变化。从结构上讲，进程包括程序段、数据段和进程控制块（PCB）
   - PCB（Process Control Block）：进程的管理者（操作系统）所需的数据都在PCB中，例如进程描述信息、进程控制和管理信息、资源分配清单、处理机相关信息。
  - 作用：使一个在多道程序环境下不能独立运行的程序（含数据）成为一个能独立运行的基本单位，一个能与其他进程并发执行的进程。
4. 进程的基本状态有运行、就绪和阻塞。引起状态转化的事件通常有：时间片用完（运行转就绪）、等待事件（运行转阻塞）、等待条件发生（阻塞转就绪）以及进程调度（就绪转运行）。
   - 运行状态：CPU、其他所需资源
   - 就绪状态：其他所需资源
   - 阻塞状态：无资源
5. 在OS中引入进程之后，一方面可以是系统中的多道程序并发执行，这不仅能有效地改善资源利用率，还可以显著地提高系统的吞吐量，但另一方面会使系统变得更加复杂。
6. 为保证多个进程能够有条不紊的运行，在多道程序系统中，必须引入进程同步机制。

   - 进程同步机制作用：是对多个相关进程在执行次序上进行协调，使并发执行的诸进程之间能按照一定的规则共享系统资源，并能很好地相互合作，从而是程序的执行具有可再现性。
7. 同时只能一个进程使用的资源称为临界资源。在进程中，访问临界资源的代码段称为临界区。为保证进程互斥访问临界资源，应在进程的临界区之前设置进入区，在临界区后设置退出区。进程中除上述进入区、临界区及退出区之外的其它部分的代码都成为剩余区。
8. 访问临界资源应遵循的准则为：空闲让进、忙则等待、有限等待、让权等待。
9. 同步是指不同进程相互合作、相互等待，互斥是指同类进程需要互斥使用资源。同步与互斥描述了进程间的两种不同制约关系。最简单的用于实现进程互斥的机制是位每一个临界资源配置一把锁**W**，当锁打开时，进程可以对该临界资源进行访问；而当锁关上时，则禁止进程访问该临界资源。而实现进程同步时，最常用的机制是信号量机制。
10. 信号量的物理意义是：当信号量值大于零时，表示可用资源的数目；当信号量值小于零时，其绝对值为在该信号量上等待的进程个数。
11. 在操作系统中引入线程概念的主要目的是减少程序并发执行时所需付出的时空开销，提高程序执行的并发速度。
    - 进程与线程：一个进程有多个线程，线程可以并发运行。
12. 三级调度的运行频率：高级调度（作业调度） < 中级调度（内存调度） < 低级调度（进程调度）

    - 高级调度：从后备队列中选择合适的作业从外存调入内存，并为其创建进程（创建态 -> 就绪态）

    - 中级调度：从挂起队列中选择合适的进程将其数据从外存调回内存（挂起态 -> 就绪态）

    - 低级调度：从就绪队列中选择一个进程为其分配CPU（就绪态 -> 运行态）
13. 进程调度方法有两类：抢占式与非抢占式。若要使当前运行进程总是优先级最高的进程，则应该选择抢占式优先级调度算法。时间片轮转调度方法也是抢占式调度方法。
    - 调度算法：先来先服务调度算法、短作业优先调度算法、优先级调度算法、时间片轮转调度算法、高响应比优先调度算法、多级队列调度算法、多级反馈队列调度算法
14. 进程调度算法采用等时间片轮转法时，若时间片过大，则会使轮转法转化为先来先服务调度算法；若时间片国小，则会在进程切换时消耗过多的系统资源和时间，效率反而会降低。
15. 在所有调度算法中，短作业优先调度算法的平均等待时间最短。
16. 用P、V操作管理临界区时，任何一个进程在进入临界区之前应调用P操作，退出临界区时应调用V操作。
17. 死锁产生的4个必要条件是：互斥条件、请求与保持条件（部分分配）、不剥夺条件和循环等待条件。要防止死锁的发生，可以破坏这4个必要条件之一，但破坏互斥条件是不太实际的。

    - 死锁：当多个进程因竞争系统资源或互相通信而处于永久阻塞状态时，若无外力作用，这些进程都将无法向前推进。这些进程中的每一个进程，均无限期地等待此组进程中某个其他进程占有的、自己永远无法得到的资源。

    - 互斥条件：只有对必须互斥使用的资源的争抢才会导致死锁

    - 不剥夺条件：进程所获得的资源在未使用完之前，**不能由其他进程强行夺走**，只能主动释放。

    - 请求和保持条件：进程**已经保持了至少一个资源**，但又提出了新的资源**请求**，而该资源又被其他进程占有，此实请求进程被阻塞，但又对自己已有的资源**保持**不放

    - 循环等待条件：存在一种进程**资源的循环等待链**，链中的每一个进程已获得的资源同时被下一个进程所请求。（循环等待未必会产生死锁）
18. 什么时候会发生死锁：对不可剥夺资源的不合理分配，可能导致死锁。



### 内存管理

1. 内存管理的功能：内存的分配和回收、地址变换、扩充内存、存储保护

2. 从写程序到程序运行需要经过编译、链接、装入三个步骤。

   - 编译：由源代码文件生成目标模块

   - 链接：由目标模块生成装入模块，链接后形成完整的逻辑地址

   - 装入：将装入模块装入内存，装入后形成物理地址

3. 三种链接方式：

   - 静态链接：在程序运行之前，先把各个目标模块及所需库链接为一个完整的可执行程序，以后不再拆开

   - 装入时动态链接：将应用程序编译后所得到的一组目标模块装入内存时采用边装入边链接的动态链接方式

   - 运行时动态链接：直到程序运行过程中需要一些模块时，才对这些模块进行链接。（缩短程序装入过程，节省大量内存空间）

3. 三种装入方式：

   - 绝对装入：编译时产生绝对地址（单道程序阶段）

   - 可重定位装入（静态重定位）：装入时将逻辑地址转换为物理地址（早期多道批处理操作系统）

   - 动态运行时装入（动态重定位）：运行时将逻辑地址转换为物理地址，需设置重定位寄存器（现代操作系统）

4. 静态重定位的特点是容易实现，无需增加硬件地址变换机构，但他要求为每个程序分配一个连续的存储区；动态重定位的特点是可以将程序分配到不连续的存储区中，在程序运行期间根据需要动态申请分配内存。

6. 用户程序中的地址称为逻辑地址（相对地址，从0开始编址），逻辑地址的集合称为地址空间；内存中的地址称为物理地址，物理地址的集合称为存储空间。通过地址重定位实现地址变换。

7. 存储保护

   - 作用：保证各进程在自己的内存空间内运行，不会越界访问；

   - 方式：利用重定位寄存器、界地址寄存器进行判断

- **内存分配算法**

1. 覆盖技术：将内存分为固定区和覆盖区，需要由程序员声明覆盖结构（已淘汰）

2. 交换技术：磁盘分为文件区和对换区，系统将某些进程暂时换出外存的对换区，把外存中某些已具备运行条件的进程换入内存（中级调度）（分为进程兑换、页面对换和分段对换）

3. 覆盖与交换的区别：覆盖是在同一个程序或进程中；交换是在不同进程之间的。

4. 连续分配管理方式（必须是一个连续的内存空间）

   - 单一连续分配：内存中只能有一道用户程序，用户程序独占整个用户区空间（MS-DOS）无外部碎片，有内部碎片

   - 固定分区分配：将用户空间划分为若干个固定大小的分区，每个分区运行一道程序（支持多道程序的系统）无外部碎片有内部碎片

   - 动态分区分配：支持多道程序，在进程装入内存时，根据进程的大小动态地建立分区（空闲分区表和空闲分区链）。无内部碎片，有外部碎片，外部碎片可用”紧凑“技术来解决。

5. 分页存储管理方式

   - 分页存储管理方式：将用户程序的地址空间分为若干个固定大小的区域，称为“页”或“页面”
   - 分段存储管理方式：将用户程序的地址空间分为若干各大小不同的段
   - 段页式存储管理方式：结合了分页和分段两种存储管理方式

   | 对比         | 分页存储管理                         | 分段存储管理                                 | 段页存储管理   |
   | ------------ | ------------------------------------ | -------------------------------------------- | :------------- |
   | 有无外部碎片 | 无                                   | 有                                           | 无             |
   | 有无内部碎片 | 有                                   | 无                                           | 有             |
   | 优点         | 内存利用率高，基本解决了内存零头问题 | 段拥有逻辑意义，便于共享、保护、和动态链接   | 兼有两者优点   |
   | 缺点         | 页缺乏逻辑意义，不能很好地满足用户   | 内存利用率不高，难以找到连续的空闲区放入整段 | 多访问一次内存 |

   <center><img src="http://ww1.sinaimg.cn/mw690/0061KkpRgy1g5d0urdgadj33i71zt1ky.jpg"/></center>

6. 虚拟内存：是指具有请求调入功能和置换功能，能从逻辑上对内存容量加以扩充的一种存储器系统。其逻辑容量由内存容量和外存容量之和所决定，其运行速度接近于内存速度。

7. 虚拟内存的特征：多次性，对换性，虚拟性

   - 多次性：一个作业中的程序和数据多次被调入内存运行
   - 对换性：一个作业中的程序和数据允许在作业的运行过程中进行换进换出
   - 虚拟性：能够从逻辑上扩充内存容量，是用户所看到的内存容量远大于实际内存容量

8. 虚拟内存实现方法：分页请求系统、请求分段系统

   - 页面置换算法：最佳置换算法、先进先出置换算法、最近最久未使用算法（LRU）、最少使用置换算法（LRU）、Clock置换算法、页面缓冲算法（PBA）

9. 产生“抖动”的原因：同时在系统中运行的进程太多，由此分配给每一个进程的物理块太少，致使每个进程在运行时频繁出现缺页。这会使得在系统中排队的等待页面调进/调出的进程数目增加。

10. 请求分页 = 基本分页 + 请求调页功能 + 页面置换功能




### 文件管理

1. 操作系统中对信息进行管理的部分叫作文件系统。
2. 文件系统是指文件、管理文件的软件及数据结构的总体。
3. 从用户角度看，文件系统的主要目的是实现对文件的按名存取。
4. 按文件的逻辑结构划分，文件分为有结构的记录式文件和无结构的流式文件。按文件的物理结构划分，文件主要分为3类：索引顺序文件、索引文件和顺序文件。
   - 顺序文件：顺序存取时速度较快
   - 索引文件：可以进行随机访问，也易于文件的增删
   - 索引顺序文件：提高了顺序存取的速度
   - 直接文件和散列文件
5. 操作系统实现按名存取的关键在于解决文件名与文件存储地址的转换。
6. 在文件系统中若采用单级目录结构，存在的最主要的一个问题是重名问题，即文件命名冲突。为了解决不同用户文件的命名冲突问题，通常在文件系统中采用多级目录。
7. 文件共享是指某一个或某一部分文件可以让事先规定的某些用户共同使用。文件保护是指避免文件拥有者或者其他用户因为有意或无意的错误操作使文件受到破坏。
8. 按用户对文件的存取权限将用户分为若干组，同时规定每一组用户对文件的访问权限。这样，所有用户组存取权限的集合称为该文件的存取控制表。对一个文件的访问，常由用户访问权限和文件属性共同限制。
9. 文件系统是指操作系统中与文件管理有关的软件和数据的集合，通常由若干层次组成，主要包含4层：基本I/O控制层、基本文件系统层、基本I/O管理程序层和逻辑文件系统层。
10. 常用的外存分配方式有连续分配、链接分配和索引分配，外存分配方式决定文件的物理结构。实现这些分配方式需要对文件存储空间进行管理，常用的文件存储空间的管理方法有空闲文件表法、空闲块链表法、位示图法和成组链接法。
11. 磁带和磁盘两种存储介质的特点是：磁盘是随机存取，磁带是顺序存取。
12. 磁盘访问时间由3部分组成，即寻道时间、旋转延迟时间及传输时间。
13. 四种重要的磁盘调度算法：先来先服务（FCFS）、最短寻道时间优先（SSTF）、扫描算法（SCAN）和循环扫描算法（CSCAN）。



### 设备管理

1. 设备控制器应具备以下功能：
   - 接受和识别来自CPU的各种指令
   - 实现CPU与设备控制器、设备控制器与设备之间的数据交换
   - 记录设备的状态供CPU查询
   - 识别所控制的每个设备的地址
2. I/O软件层次结构：
   - 用户层软件
   - 设备独立性软件
   - 设备驱动程序
   - 中断处理程序
   - 硬件

3. 按照共享属性可以将设备分为独占型设备，共享型设备，虚拟设备。大多数低速设备都属于独享设备。

4. 设备与内存之间的数据传输控制方式有直接控制方式、中断控制方式、通道控制方式、DMA控制方式，其中通道控制方式占用CPU的时间最短。

5. 通道是负责I/O的处理器，与一般处理器相比，通道的指令类型单一，没有自己的内存，与CPU共享内存

6. DMA控制方式需要CPU来控制传输的数据块大小、传输的内存位置，而通道控制方式中这些信息都是由通道控制的。一个DMA控制器只能控制一台设备的数据传输，而一个通道可以控制多台设备的数据传输。

7. 引起中断发生的事件称为中断源。发生中断时，刚执行完那条指令所在的单元号被称为断点，断点的逻辑猴急指令的单元号被称为恢复点。如果多个中断发生，系统将根据中断响应优先级来响应优先级最高的中断请求。

8. 根据系统设置的缓冲区个数，可以将缓冲技术分为单缓冲、双缓冲、循环缓冲和缓冲池。

9. 进行设备分配时所需要的数据表格主要有设备控制表、设备控制器控制表、通道控制表、系统控制表。

10. 在操作系统中，一种空间换取时间的资源转换技术是假脱机技术（SPOOLing）。SPOOLing系统有磁盘中的输入井和输出井，内存中的输入缓冲区和输出缓冲区以及输入进程和输出进程组成。SPOOLing技术是在共享设备上模拟独占设备。

11. 虚拟设备是指通过虚拟技术将一台独占设备改造成若干台逻辑设备，供若干个用户进程同时使用。这种经过虚拟技术处理后的设备成为虚拟设备。

